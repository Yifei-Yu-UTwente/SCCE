---
layout:
title:
date: 2025-02-01 00:00:00 -1000
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickMatch</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ... (existing styles remain unchanged) ... */

        /* Simulation Button */
        .simulation-btn {
            margin-top: 10px;
            padding: 10px;
            background: #007bff; /* Blue */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .simulation-btn.active {
            background: #28a745; /* Green when active */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">QuickMatch</h1>
        <p class="subtitle">Version 0, February 2025, Yifei Yu</p>
        <button class="how-it-works-btn" onclick="openModal()">?</button>

        <!-- Resource Block -->
        <div class="block">
            <div class="resource-selection">
                <h2>Resources</h2>
                <select id="preset-resources">
                    <option value="">Select a preset resource</option>
                    <option value="Waste Heat">Waste Heat</option>
                    <option value="Scrap Metal">Scrap Metal</option>
                    <option value="Chemical Byproduct">Chemical Byproduct</option>
                    <option value="Industrial Water">Industrial Water</option>
                </select>
                <input type="text" id="new-resource" placeholder="Or add a new resource">
                <button onclick="addResource()">Add Resource</button>
                <div class="resource-list" id="resource-list"></div>
            </div>
        </div>

        <!-- Criteria Block -->
        <div class="block">
            <div class="criteria" id="criteria-list">
                <h2>Criteria</h2>
                <div class="scale-boundary">
                    <label>Min: <input type="number" id="min-scale" value="0"></label>
                    <label>Max: <input type="number" id="max-scale" value="10"></label>
                </div>
            </div>
            <input type="text" id="new-criterion" placeholder="Add new criterion">
            <button onclick="addCriterion()">Add Criterion</button>
        </div>

        <!-- Matchmaking Map Block -->
        <div class="block">
            <div class="matchmaking-map">
                <h2>Matchmaking Map</h2>
                <button onclick="updateMap()">Update Map</button>
                <button id="simulation-btn" class="simulation-btn" onclick="toggleSimulation()">Enable Simulation</button>
                <canvas id="matchmakingChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Popup Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2>How it works?</h2>
            <p><strong>Add Resources:</strong> Use the dropdown or text input to add resources.</p>
            <p><strong>Add/Remove Criteria:</strong> Add new criteria or remove existing ones.</p>
            <p><strong>Customize Scale:</strong> Adjust the "Min" and "Max" values to set the scale boundaries for scoring.</p>
            <p><strong>Score Resources:</strong> Use sliders to assign scores to each resource based on the criteria. The numeric score is displayed next to the slider, and the slider bar fills with blue as the score increases.</p>
            <p><strong>Update Map:</strong> Click the "Update Map" button to refresh the matchmaking map with the latest scores.</p>
            <p><strong>Simulation:</strong> Toggle the simulation to see the potential effects of using a circularity hub (e.g., increased prices, reduced distances).</p>
            <button onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        let criteria = ["Distance", "Availability", "Market Demand", "Price", "Technical Cleanness"];
        let resources = [];
        let minScale = 0;
        let maxScale = 10;
        let isSimulationActive = false; // Track simulation state

        // Preload resources with random scores
        function preloadResources() {
            const presetResources = ["Waste Heat", "Scrap Metal"];
            presetResources.forEach(resource => {
                const scores = criteria.map(() => Math.floor(Math.random() * (maxScale - minScale + 1)) + minScale);
                resources.push({ name: resource, scores });
                addResourceToDOM(resource, scores);
            });
            updateMap(); // Update the map with preloaded resources
        }

        // Add a resource to the DOM
        function addResourceToDOM(resourceName, scores) {
            const list = document.getElementById("resource-list");
            const item = document.createElement("div");
            item.className = "resource-item";

            // Add resource name
            const nameSpan = document.createElement("span");
            nameSpan.textContent = resourceName;
            item.appendChild(nameSpan);

            // Add sliders for each criterion
            scores.forEach((score, index) => {
                const sliderContainer = document.createElement("div");
                sliderContainer.className = "slider-container";
                sliderContainer.innerHTML = `
                    <label>${criteria[index]}:</label>
                    <input type="range" class="slider" min="${minScale}" max="${maxScale}" value="${score}">
                    <span class="score-value">${score}</span>
                `;
                // Update score value when slider changes
                const slider = sliderContainer.querySelector(".slider");
                const scoreValue = sliderContainer.querySelector(".score-value");
                slider.oninput = function () {
                    scoreValue.textContent = this.value;
                    updateSliderFill(this);
                };
                updateSliderFill(slider); // Initialize slider fill
                item.appendChild(sliderContainer);
            });

            // Add delete button
            const deleteBtn = document.createElement("button");
            deleteBtn.textContent = "Delete";
            deleteBtn.className = "delete-btn";
            deleteBtn.onclick = function () {
                list.removeChild(item);
                resources = resources.filter(r => r.name !== resourceName);
            };
            item.appendChild(deleteBtn);

            list.appendChild(item);
        }

        // Toggle simulation
        function toggleSimulation() {
            isSimulationActive = !isSimulationActive;
            const simulationBtn = document.getElementById("simulation-btn");
            simulationBtn.textContent = isSimulationActive ? "Disable Simulation" : "Enable Simulation";
            simulationBtn.classList.toggle("active", isSimulationActive);
            updateMap(); // Refresh the map with updated scores
        }

        // Apply simulation effects to scores
        function applySimulation(scores) {
            if (!isSimulationActive) return scores; // Return original scores if simulation is off

            // Simulate effects: Increase Price, Decrease Distance
            return scores.map((score, index) => {
                if (criteria[index] === "Price") return Math.min(score + 2, maxScale); // Increase Price
                if (criteria[index] === "Distance") return Math.max(score - 2, minScale); // Decrease Distance
                return score; // No change for other criteria
            });
        }

        // Update the matchmaking map
        function updateMap() {
            const ctx = document.getElementById("matchmakingChart").getContext("2d");
            if (window.chartInstance) {
                window.chartInstance.destroy();
            }

            // Collect scores from sliders
            const resourceItems = document.querySelectorAll("#resource-list .resource-item");
            resources = [];
            resourceItems.forEach((item, index) => {
                const resourceName = item.querySelector("span").textContent;
                const sliders = item.querySelectorAll(".slider");
                const scores = Array.from(sliders).map(slider => parseInt(slider.value, 10));
                resources.push({ name: resourceName, scores });
            });

            // Vibrant colour palette for the chart
            const colours = [
                "#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0", "#9966FF",
                "#FF9F40", "#C9CBCF", "#FFCD56", "#4D5360", "#F7464A"
            ];

            window.chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: criteria,
                    datasets: resources.map((res, index) => ({
                        label: res.name,
                        data: isSimulationActive ? applySimulation(res.scores) : res.scores,
                        borderColor: colours[index % colours.length], /* Vibrant colours */
                        borderDash: isSimulationActive ? [5, 5] : [], /* Dashed line for simulation */
                        fill: false,
                        tension: 0.1
                    }))
                },
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: maxScale
                        }
                    }
                }
            });
        }

        // Modal functions
        function openModal() {
            document.getElementById("modal").style.display = "flex";
        }

        function closeModal() {
            document.getElementById("modal").style.display = "none";
        }

        // Initial render
        renderCriteria();
        preloadResources(); // Preload resources with random scores
    </script>
</body>
</html>
